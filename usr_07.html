---
layout: vimdoc
helpname: 'usr_07'
---
<div id='vimCodeElement'>
<a class="Constant" href="usr_07.html" name="usr_07.txt">usr_07.txt</a>&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;<span class="Identifier">Vim バージョン 9.0.</span>&nbsp;&nbsp;Last change: 2020 Mar 23<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VIM USER MANUAL - by Bram Moolenaar<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 複数のファイルを開く<br>
<br>
<br>
どんなにファイルが多くても心配はいりません。Vim を複数起動することなしに、それ<br>
らのファイルを編集できます。作業するファイルのリストを定義して、他のファイルに<br>
ジャンプしたりテキストをコピーしたりできます。<br>
<br>
<a class="Identifier" href="usr_07.html#07.1">07.1</a>&nbsp;&nbsp;他のファイルを開く<br>
<a class="Identifier" href="usr_07.html#07.2">07.2</a>&nbsp;&nbsp;ファイルのリスト<br>
<a class="Identifier" href="usr_07.html#07.3">07.3</a>&nbsp;&nbsp;他のファイルにジャンプする<br>
<a class="Identifier" href="usr_07.html#07.4">07.4</a>&nbsp;&nbsp;バックアップファイル<br>
<a class="Identifier" href="usr_07.html#07.5">07.5</a>&nbsp;&nbsp;他のファイルにテキストをコピーする<br>
<a class="Identifier" href="usr_07.html#07.6">07.6</a>&nbsp;&nbsp;読み込み専用モード<br>
<a class="Identifier" href="usr_07.html#07.7">07.7</a>&nbsp;&nbsp;ファイル名の変更<br>
<br>
次章:&nbsp;<a class="Identifier" href="usr_08.html">usr_08.txt</a>&nbsp;&nbsp;ウィンドウの分割<br>
前章:&nbsp;<a class="Identifier" href="usr_06.html">usr_06.txt</a>&nbsp;&nbsp;構文強調表示<br>
目次:&nbsp;<a class="Identifier" href="usr_toc.html">usr_toc.txt</a><br>
<br>
<span class="PreProc">==============================================================================</span><br>
<a class="Constant" href="usr_07.html#07.1" name="07.1">07.1</a>&nbsp;&nbsp;他のファイルを開く<br>
<br>
いままでは、ファイルを開くごとに Vim を起動しなければなりませんでしたが、もっ<br>
と簡単な方法があります。次のコマンドを使ってください:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:edit foo.txt</div>
<br>
ファイル名は &quot;foo.txt&quot; に限らず何でも使えます。Vim は現在のファイルを閉じて、<br>
指定されたファイルを開きます。ファイルの変更が保存されていない場合は、エラー<br>
メッセージが表示され、新しいファイルは開かれません。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="PreProc">E37: 最後の変更が保存されていません (! で変更を破棄)</span><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Todo">Note</span>:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;エラーメッセージの先頭には エラーID が表示されます。エラーの意味や原因<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;がわからない場合は、この ID をヘルプで引いてください。上記エラーの場合<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;は、このようにします:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:help E37</div>
<br>
このエラーを回避するには、次のコマンドでファイルを保存してください:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:write</div>
<br>
あるいは、変更を破棄して新しいファイルを開くこともできます。(!) 文字を使ってく<br>
ださい:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:edit! foo.txt</div>
<br>
ファイルの変更を保存せずに他のファイルを開きたい場合は、ファイルを隠す方法もあ<br>
ります:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:hide edit foo.txt</div>
<br>
ファイルの変更はまだ破棄されませんが、ファイルは画面外に隠れてしまいます。詳し<br>
くは<a class="Identifier" href="usr_22.html#22.4">22.4</a>バッファリスト で説明します。<br>
<br>
<span class="PreProc">==============================================================================</span><br>
<a class="Constant" href="usr_07.html#07.2" name="07.2">07.2</a>&nbsp;&nbsp;ファイルのリスト<br>
<br>
Vim を起動するときに、複数のファイルを指定することができます。例:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vim one.c two.c three.c</div>
<br>
このコマンドは Vim を起動し、三つのファイルを開くように指示しています。Vim は<br>
一つ目のファイル (one.c) だけを表示します。そのファイルの編集が終わり、次のファ<br>
イル (two.c) を編集したい場合はこのコマンドを使います:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:next</div>
<br>
ファイルの変更が保存されていない場合は、エラーメッセージが表示され、&quot;:next&quot; コ<br>
マンドは中断されます。前節で述べた &quot;:edit&quot; の場合と同じです。変更を破棄するに<br>
は次のコマンドを使います。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:next!</div>
<br>
しかしほとんどの場合、変更を保存してから次のファイルを開くと思います。それには<br>
専用のコマンドが用意されています。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:wnext</div>
<br>
これは次の二つのコマンドを使うのと同じ結果となります。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:write<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:next</div>
<br>
<br>
<span class="Statement">私はドコにいるの？</span><br>
<br>
今編集しているのが引数リスト中のどのファイルなのかは、ウィンドウタイトルを見れ<br>
ばわかります。そこに &quot;(2 of 3)&quot; のような表示があります。この場合は全部で三つの<br>
ファイルがあり、今は二つ目を編集しているという意味です。<br>
次のコマンドでファイルの一覧を表示できます:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:args</div>
<br>
これは &quot;arguments&quot; の省略形です。結果は次のように表示されます。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="PreProc">one.c [two.c] three.c</span><br>
<br>
Vim を起動したときに指定したファイルが表示されます。編集中のファイル (ここでは<br>
&quot;two.c&quot;) は [] 記号で囲んで表示されます。<br>
<br>
<br>
<span class="Statement">他のファイルへの移動</span><br>
<br>
これはファイルを一つ戻るコマンドです。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:previous</div>
<br>
&quot;:next&quot; コマンドと同じ動作ですが、移動する方向が違います。このコマンドにも、<br>
ファイル保存してから移動する専用のコマンドがあります。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:wprevious</div>
<br>
一覧の最後のファイルに移動するには次のコマンドを使います。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:last</div>
<br>
最初のファイルに戻るには次のコマンドです。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:first</div>
<br>
&quot;:wlast&quot; とか &quot;:wfirst&quot; みたいなコマンドはありません。<br>
<br>
&quot;:next&quot; と &quot;:previous&quot; にはカウンタを指定できます。例えば、二つ先のファイルに<br>
進むにはこのようにします。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:2next</div>
<br>
<br>
<span class="Statement">自動保存</span><br>
<br>
いろんなファイルを編集して回るときには、&quot;:write&quot; で保存するのを忘れないでくだ<br>
さい。変更を保存せずに移動しようとすると、エラーメッセージが表示されます。移動<br>
するときはいつでも変更を保存したいと思った場合は、次のように設定してください。<br>
変更が自動的に保存されるようになります。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:set autowrite</div>
<br>
保存して欲しくないファイルを編集するときは、機能をオフに設定してください。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:set noautowrite</div>
<br>
<br>
<span class="Statement">他のファイルリストで編集する</span><br>
<br>
Vim を再起動しなくても、ファイルリストを変更できます。例えば、他の三つのファイ<br>
ルを編集するには次のようにします。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:args five.c six.c seven.h</div>
<br>
シェルと同じようにワイルドカードを使うこともできます。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:args *.txt</div>
<br>
リストの最初のファイルがまず開かれます。ここでも、現在のファイルの変更をまだ保<br>
存していない場合は、ファイルを保存するか、&quot;:args!&quot; (! が付いています) を使って<br>
変更を破棄する必要があります。<br>
<br>
<br>
<span class="Statement">最後のファイルまで編集した？</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="usr_07.html#arglist-quit" name="arglist-quit">arglist-quit</a><br>
ファイルリストが使われると、Vim は、すべてのファイルが編集対象だと判断します。<br>
間違って Vim を終了してしまうことがないように、すべてのファイルをまだ開いてい<br>
ないのに終了しようとした場合は、エラーメッセージが表示されます:<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="PreProc">E173: 編集すべきファイルがあと 46 個あります。</span><br>
<br>
本当に終了してよければ、もう一度終了コマンドを実行してください。今度は終了でき<br>
ます (間に他のコマンドを挟まないでください)。<br>
<br>
<span class="PreProc">==============================================================================</span><br>
<a class="Constant" href="usr_07.html#07.3" name="07.3">07.3</a>&nbsp;&nbsp;他のファイルにジャンプする<br>
<br>
<span class="Special">CTRL-^</span>&nbsp;を使うと二つのファイル間を素早く移動できます(日本語キーボードなら ^ は<br>
'-' キーの右側 (「へ」キー) にあります)。例:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:args one.c two.c three.c</div>
<br>
上を実行すると &quot;one.c&quot; が開きます。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:next</div>
<br>
これで、&quot;two.c&quot; になりました。ここで&nbsp;<span class="Special">CTRL-^</span>&nbsp;を使うと &quot;one.c&quot; に戻ります。もう<br>
一度&nbsp;<span class="Special">CTRL-^</span>&nbsp;を押すと &quot;two.c&quot; に戻ります。さらに&nbsp;<span class="Special">CTRL-^</span>&nbsp;を使うと &quot;one.c&quot; になり<br>
ます。さて、ここで次のコマンドを実行します。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:next</div>
<br>
すると、&quot;three.c&quot; になります。<span class="Special">CTRL-^</span>&nbsp;コマンドはファイルリスト中での現在地を変<br>
更しません。&quot;:next&quot; や &quot;:previous&quot; のようなコマンドだけが現在地を変更します。<br>
<br>
直前に編集していたファイルのことをオルタネートファイル (alternate file) と言い<br>
ます。Vim の起動直後はオルタネートファイルがまだ無いため&nbsp;<span class="Special">CTRL-^</span>&nbsp;は動作しませ<br>
ん。<br>
<br>
<br>
<span class="Statement">定義済マーク</span><br>
<br>
他のファイルにジャンプすると、二つの定義済マークが使えるようになります。これは<br>
非常に便利です。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`&quot;</div>
<br>
このコマンドを実行すると、以前にファイルを開いていたときにいた場所にカーソルが<br>
移動します。もう一つは、最後に変更を加えた場所に設定されたマークです。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`.</div>
<br>
例えば、&quot;one.txt&quot; を編集しているとします。ファイルの真ん中あたりで &quot;x&quot; を使っ<br>
て文字を削除しました。そして、&quot;G&quot; を使って最後の行に移動し、&quot;:w&quot; でファイルを<br>
保存します。他のファイルをいくつか編集してから、&quot;:edit one.txt&quot; で &quot;one.txt&quot;<br>
に戻ってきました。ここで、`&quot; を実行すると、ファイルの最後の行にカーソルが移動<br>
します。`. を実行すると、文字を削除した場所に移動します。ファイル内をいろいろ<br>
と移動した後でも、`&quot; と `. は同じ場所を覚えています。少なくとも、他の変更を加<br>
えたり、別のファイルに移動したりするまでは。<br>
<br>
<br>
<span class="Statement">ファイルマーク</span><br>
<br>
<a class="Identifier" href="usr_03.html#03.10">03.10</a>&nbsp;節では &quot;mx&quot; でマークを付け、&quot;`x&quot; でその場所にジャンプする方法を説明し<br>
ました。そのマークはファイルの中だけで使えます。別のファイルを開いて、それに同<br>
じマークを付けても、マークはそのファイルに固有のものとなります。つまり各ファイ<br>
ルはそれぞれのマークを持っていて、ファイル内に閉じているということです。いまま<br>
では、マークに小文字を使ってきましたが、大文字のマークも使えます。<br>
大文字のマークはグローバルで、どのファイルからでも使えます。例えば &quot;foo.txt&quot;<br>
というファイルを開き、&quot;50%&quot; コマンドでファイルの真ん中にジャンプして、その場所<br>
に F というマークを付けたとします:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;50%mF</div>
<br>
次に &quot;bar.txt&quot; を開き、最終行にマーク B を付けます:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GmB</div>
<br>
さて、ここで &quot;'F&quot; コマンドを使うと、いきなり foo.txt の真ん中にジャンプできま<br>
す。さらに、他のファイルを開いてから &quot;'B&quot; を入力すると、bar.txt の行末に移動で<br>
きます。<br>
<br>
他の場所を設定するまで、ファイルマークは同じ場所を記憶しています。そのため、一<br>
度マークを付ければ、何時間も編集を行ってからでもそのマークに戻って来ることがで<br>
きます。<br>
マークの文字とマークを付けた場所が連想できるような単純なルールを決めておくとよ<br>
いでしょう。例えば、ヘッダーファイルは H、makeファイルは M、C 言語のソースには<br>
C といった具合です。<br>
<br>
マークが置いてある場所を確認するには、&quot;:marks&quot; コマンドにそのマークを指定して<br>
ください。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:marks M</div>
<br>
マークを複数指定しても構いません。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:marks MCP</div>
<br>
マークを使わなくても、<span class="Special">CTRL-O</span>&nbsp;と&nbsp;<span class="Special">CTRL-I</span>&nbsp;を使えば、古い場所と新しい場所の間を<br>
ジャンプできることをお忘れなく。<br>
<br>
<span class="PreProc">==============================================================================</span><br>
<a class="Constant" href="usr_07.html#07.4" name="07.4">07.4</a>&nbsp;&nbsp;バックアップファイル<br>
<br>
初期設定ではバックアップファイルは作成されません。バックアップファイルが必要な<br>
ら、次のコマンドを実行してください:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:set backup</div>
<br>
バックアップファイルの名前は、ファイル名の後ろに ~ を加えた名前になります。<br>
例えば、ファイル名が data.txt なら、バックアップファイルは data.txt~ です。<br>
&nbsp;~ 以外の文字を使いたい場合は、次のように設定してください:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:set backupext=.bak</div>
<br>
これで、バックアップファイルの名前が data.txt.bak になります。<br>
もう一つのオプション&nbsp;<a class="Type" href="options.html#'backupdir'">'backupdir'</a>&nbsp;についても説明しましょう。これはバックアップ<br>
ファイルを保存するディレクトリを指定するオプションです。初期設定ではバックアッ<br>
プは元ファイルと同じディレクトリに保存されます。たいていの場合はこれで問題ない<br>
はずです。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Todo">Note</span>:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Type" href="options.html#'writebackup'">'writebackup'</a>&nbsp;がオンの場合、<a class="Type" href="options.html#'backup'">'backup'</a>&nbsp;がオフでもバックアップファイルは<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;作成されますが、ファイルの保存が成功すると、そのバックアップファイルは<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;すぐに削除されます。これは、ファイルを保存できなかったときに、オリジナ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ルファイルが失われないようにするための機能です。(失敗の原因は、例えば、<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ディスクがいっぱいになったというのが一番ありがちな理由です。雷にやられ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;るというのも可能性は低いですがありうることです)。<br>
<br>
<br>
<span class="Statement">オリジナルファイルを残す</span><br>
<br>
ソースファイルを編集していると、変更を加える前のファイルを残しておきたいときが<br>
あります。しかし、バックアップファイルはファイルを保存するたびに上書きされるの<br>
で、直前のバックアップしか残らず、最初のファイルはなくなってしまいます。<br>
オリジナルのファイルを残しておきたい場合は、<a class="Type" href="options.html#'patchmode'">'patchmode'</a>&nbsp;オプションを設定してく<br>
ださい。バックアップファイルを最初に作成するときに使う拡張子を指定します。次の<br>
ように設定してください:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:set patchmode=.orig</div>
<br>
例えば、はじめて data.txt を開いたときに、変更を加え、保存しようとすると、変更<br>
前のファイルが &quot;data.txt.orig&quot; という名前でコピーされます。<br>
その後、ファイルを変更しても、既に &quot;data.txt.orig&quot; があるので、上書きはされま<br>
せん。この場合もバックアップファイルは &quot;data.txt~&quot; (もしくは&nbsp;<a class="Type" href="options.html#'backupext'">'backupext'</a>&nbsp;で指<br>
定した名前) で作成されます。<br>
<a class="Type" href="options.html#'patchmode'">'patchmode'</a>&nbsp;が空のまま (初期設定) だと、オリジナルファイルは残りません。<br>
<br>
<span class="PreProc">==============================================================================</span><br>
<a class="Constant" href="usr_07.html#07.5" name="07.5">07.5</a>&nbsp;&nbsp;他のファイルにテキストをコピーする<br>
<br>
ここではファイルから別のファイルにテキストをコピーする方法を説明します。簡単な<br>
例で始めましょう。コピーしたいテキストを含んでいるファイルを開きます。テキスト<br>
の先頭にカーソルを移動して &quot;v&quot; を押すとビジュアルモードが開始します。テキスト<br>
の末尾までカーソルを移動して &quot;y&quot; を押します。これでテキストがヤンク (コピー)<br>
されました。<br>
<br>
例えば、上の段落をコピーするには、次のようにします。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:edit thisfile<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/ここでは<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vjjjj$y</div>
<br>
次に、このテキストをプット (ペースト) したいファイルを開きます。テキストをプッ<br>
トしたい場所にカーソルを動かし、&quot;p&quot; コマンドでプットします。<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:edit otherfile<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/どこか<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p</div>
<br>
当然ながら、テキストのヤンクには他にもいろんなコマンドが使えます。例えば、&quot;V&quot;<br>
でビジュアルモードを開始すると行単位で選択できますし、<span class="Special">CTRL-V</span>&nbsp;で矩形選択もでき<br>
ます。&quot;Y&quot; で一行をヤンクしたり、&quot;yaw&quot; で単語をヤンク (yank-a-word) するなど、<br>
いろいろできます。<br>
&quot;p&quot; コマンドはカーソルの後にテキストをプットします。カーソルの前にプットするに<br>
は &quot;P&quot; を使います。Vim はヤンクしたときの選択単位 (行選択や矩形選択) を覚えて<br>
いて、同じ単位でプットします。<br>
<br>
<br>
<span class="Statement">レジスタを使う</span><br>
<br>
あるファイルから別のファイルに数箇所のテキストをコピーしたいとき、何度も何度も<br>
ファイルを切り換えると時間がかかります。テキストをレジスタにコピーして手間を省<br>
きましょう。<br>
レジスタとは、Vim がテキストを保持する場所です。ここでは a から z までの名前が<br>
付いたレジスタを使います (レジスタは他にもあります)。では、テキストをレジスタ<br>
f (fはfirstのつもり) にヤンクしてみましょう。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;fyas</div>
<br>
&quot;yas&quot; コマンドで文をヤンクしています。&quot;f はテキストをレジスタ f に入れるための<br>
指定です。この指定はヤンクコマンドの直前に指定します。<br>
さらに三行をレジスタ l (lはlineのつもり) にヤンクしてみましょう。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;l3Y</div>
<br>
カウンタ (回数指定) は &quot;l の直前に指定することもできます。テキストのブロック<br>
(矩形選択) をレジスタ b (bはblockのつもり) にヤンクする場合は次のようにしま<br>
す。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CTRL-Vjjww&quot;by</div>
<br>
レジスタ指定 &quot;b を &quot;y&quot; コマンドの直前で指定している点に注意してください。これ<br>
は重要なことです。これを &quot;w&quot; コマンドより前に置いてしまうとうまく動きません。<br>
さて、f、l、b の三つのレジスタにテキストをヤンクできました。他のファイルを開い<br>
て、テキストを挿入したい場所にカーソルを移動し、レジスタの内容をプットしましょ<br>
う。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;fp</div>
<br>
ヤンクの場合と同じく、レジスタ指定 &quot;f は &quot;p&quot; コマンドより前に指定します。<br>
どのレジスタからプットしても構いません。他のテキストをヤンクし直さない限り、レ<br>
ジスタの内容は変わらないので、同じレジスタを何度でも好きなだけプットできます。<br>
<br>
テキストを削除するときにも、レジスタを指定できます。テキストを何ヶ所かに移動す<br>
るときなどに使ってください。例えば、単語を削除 (delete-a-word) してその内容を<br>
レジスタ w に入れるには次のようにします。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;wdaw</div>
<br>
何度も言うようですが、レジスタ指定は削除コマンド &quot;d&quot; の前に置いてください。<br>
<br>
<br>
<span class="Statement">ファイルに追記する</span><br>
<br>
文章を一つのファイルにまとめたい場合は、次のコマンドを使います。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:write &gt;&gt; logfile</div>
<br>
カレントファイルの内容が &quot;logfile&quot; の末尾に追記されます。テキストをコピーして、<br>
&quot;logfile&quot; を開き、テキストをプットするより簡単です。作業を 2 手節約できます。<br>
ただし、ファイルの末尾への追加しかできません。<br>
ファイルの一部だけ追記したい場合は、ビジュアルモードでテキストを選択してから<br>
&quot;:write&quot; を実行してください。テキストを選択する方法は他にもありますが、10 章で<br>
説明します。<br>
<br>
<span class="PreProc">==============================================================================</span><br>
<a class="Constant" href="usr_07.html#07.6" name="07.6">07.6</a>&nbsp;&nbsp;読み込み専用モード<br>
<br>
ファイルを変更する気はなく、ただファイルの内容を見たいだけのときがあります。普<br>
通に開くと、うっかり &quot;:w&quot; を実行して元のファイルを上書きしてしまう危険がありま<br>
す。そういうときは、読み込み専用モードでファイルを開いてください。<br>
Vim を読み込み専用モードで起動するには、次のコマンドを使います。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vim -R file</div>
<br>
Unix なら、次のコマンドも同じ意味になります。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;view file</div>
<br>
&quot;file&quot; が読み込み専用モードで開きます。&quot;:w&quot; をしようとしても、エラーメッセージ<br>
が表示され保存はされません。<br>
ファイルに変更を加えようとすると、次のような警告が表示されます。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="PreProc">W10: 警告: 読込専用ファイルを変更します</span><br>
<br>
警告は出ますが、変更は可能です。これは、例えばファイルを読みやすくフォーマット<br>
したりするためです。<br>
読み込み専用モードであることを忘れて、ファイルを修正してしまったようなときは、<br>
write コマンドに ! を付けて強制保存してください。<br>
<br>
完全にファイルの変更を禁止したい場合は、次のようにしてください。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vim -M file</div>
<br>
これで、内容を変更しようとしてもエラーになります。例えば、ヘルプファイルはこの<br>
モードで表示されています。変更しようとすると、次のエラーメッセージが表示されま<br>
す。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="PreProc">E21: 'modifiable'がオフなので、変更できません</span><br>
<br>
-M 引数を使えば Vim を閲覧モードに設定できますが、これは自主規制みたいなもの<br>
で、次のコマンドを使えば制限はなくなってしまいます。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:set modifiable<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:set write</div>
<br>
<span class="PreProc">==============================================================================</span><br>
<a class="Constant" href="usr_07.html#07.7" name="07.7">07.7</a>&nbsp;&nbsp;ファイル名の変更<br>
<br>
新しいファイルを作成するときに、目的に近いファイルがあるなら、それを利用するの<br>
が効率的です。例えば、ファイルを移動するプログラムを作りたいとしましょう。ファ<br>
イルをコピーするプログラムがすでにあるので、それを流用することにしました。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:edit copy.c</div>
<br>
新しいプログラムに必要ない部分は削除してしまいましょう。次に、このファイルを新<br>
しい名前で保存する必要があります。そのためのコマンドが &quot;:saveas&quot; です。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:saveas move.c</div>
<br>
指定した名前でファイルが保存され、そのファイルが開かれます。そのため、次に<br>
&quot;:write&quot; したときは &quot;move.c&quot; に保存されます。&quot;copy.c&quot; は変更されません。ファイ<br>
ルを保存せずに、ファイルの名前だけ変更したい場合は、次のコマンドを使います。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:file move.c</div>
<br>
そのファイル (move.c) は、実際のファイルではないので、&quot;開いていない&quot; (not<br>
edited) 扱いになります。ファイルを保存しようとすると、次のメッセージが表示され<br>
ることがあります。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="PreProc">E13: ファイルが存在します (! を追加で上書)</span><br>
<br>
これは、実際のファイルを間違って上書きしてしまわないようにするためです。<br>
<br>
<span class="PreProc">==============================================================================</span><br>
<br>
次章:&nbsp;<a class="Identifier" href="usr_08.html">usr_08.txt</a>&nbsp;&nbsp;ウィンドウの分割<br>
<br>
Copyright: see&nbsp;<a class="Identifier" href="usr_01.html#manual-copyright">manual-copyright</a>&nbsp;&nbsp;vim:tw=78:ts=8:noet:ft=help:norl:<br>
</div>
