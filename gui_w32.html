---
layout: vimdoc
helpname: 'gui_w32'
---
<div id='vimCodeElement'>
<a class="Constant" href="gui_w32.html" name="gui_w32.txt">gui_w32.txt</a>&nbsp;&nbsp; For&nbsp;<span class="Identifier">Vim バージョン 9.0.</span>&nbsp;&nbsp;Last change: 2022 Mar 09<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Identifier">VIMリファレンスマニュアル&nbsp;&nbsp;&nbsp;&nbsp;by Bram Moolenaar</span><br>
<br>
<br>
Win32でのVimのグラフィカルユーザーインターフェイス&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#gui-w32" name="gui-w32">gui-w32</a>&nbsp;<a class="Constant" href="gui_w32.html#win32-gui" name="win32-gui">win32-gui</a><br>
<br>
1. GUIを始める&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Identifier" href="gui_w32.html#gui-w32-start">gui-w32-start</a><br>
2. デフォルトエディタVim&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Identifier" href="gui_w32.html#vim-default-editor">vim-default-editor</a><br>
3. クリップボードを使う&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Identifier" href="gui_w32.html#gui-clipboard">gui-clipboard</a><br>
4. シェルコマンド&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Identifier" href="gui_w32.html#gui-shell-win32">gui-shell-win32</a><br>
5. 特別な色&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Identifier" href="gui_w32.html#win32-colors">win32-colors</a><br>
6. ダイアログとブラウズ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Identifier" href="gui_w32.html#gui-w32-dialogs">gui-w32-dialogs</a><br>
7. コマンドライン引数&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Identifier" href="gui_w32.html#gui-w32-cmdargs">gui-w32-cmdargs</a><br>
8. その他色々&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Identifier" href="gui_w32.html#gui-w32-various">gui-w32-various</a><br>
<br>
その他の関連した文章:<br>
<a class="Identifier" href="gui.html">gui.txt</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GUIの一般的な要素。<br>
<a class="Identifier" href="os_win32.html">os_win32.txt</a>&nbsp;&nbsp;Win32特有の要素。<br>
<br>
<br>
<span class="PreProc">==============================================================================</span><br>
1. GUIを始める&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#gui-w32-start" name="gui-w32-start">gui-w32-start</a><br>
<br>
Win32のGUIバージョンは、どんな名前で起動されたかなんておかまい無しに、いつも<br>
GUIでスタートする。<br>
<br>
GUIは常にWindowsのサブシステムとして実行される。ほとんどのシェルはVimを起動し<br>
た直後にコマンドプロンプトへ自動的に復帰する。そうでなかったら、&quot;start&quot; コマン<br>
ドを使うと良い:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;start gvim [options] file ..</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#E988" name="E988">E988</a><br>
コンソールバージョンに&nbsp;<a class="Identifier" href="starting.html#-g">-g</a>&nbsp;オプションを付けても gvim.exe が実行されて GUI を<br>
スタートできる。<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vim -g&nbsp;<span class="Special">[options]</span>&nbsp;file ..<br>
この機能を動作させるには、gvim.exe が vim.exe と同一のディレクトリに存在し、か<br>
つこの機能を有効にしてコンパイルされていなければならない。<br>
<br>
コンソールバージョンから&nbsp;<a class="Comment" href="gui_x11.html#:gui">:gui</a>&nbsp;を使うこともできる。しかし、これは実験的な機能<br>
で、かつこの機能を有効にしてコンパイルされていなければならない。<br>
セッションファイルを使って現在のコンソール Vim の状態が GUI Vim で再生成される。<br>
<br>
<span class="Todo">Note</span>: 全てのフォント(太字、斜体)は同じ大きさでなければならない!!! そうしない<br>
場合、文字が欠けたり表示がゴチャゴチャになったりしてしまうだろう。Vimはフォン<br>
トの大きさを検査していない。画面上でのピクセルサイズが同じでなければならない。<br>
同じポイントサイズのフォントでも、同じピクセルサイズのフォントだとは限らないこ<br>
とに注意! 加えてフォントの位置情報(アセントとディセント)も同じでなければなら<br>
ない。<br>
<br>
Win32 GUIではメニューが拡張されている: &quot;編集/フォント設定&quot;。Windowsの標準フォ<br>
ントセレクトダイアログが起動される。<br>
<br>
メニューの高さ設定は、Win32 GUIでは動作しない。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#gui-win32-maximized" name="gui-win32-maximized">gui-win32-maximized</a><br>
Vimのウィンドウを最大化した状態で起動したいのならば、vimrcかgvimrcに次のコマン<br>
ドを書き加える:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;au GUIEnter * simalt ~x</div>
<br>
<br>
Vim をプラグインとして使う&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#gui-w32-windowid" name="gui-w32-windowid">gui-w32-windowid</a><br>
<br>
普通に gvim が起動されると、gvim のウィンドウがトップレベルで作成される。コマ<br>
ンドラインオプション&nbsp;<a class="Identifier" href="starting.html#--windowid">--windowid</a>&nbsp;に10進または16進の数値を指定すると、Vim はそ<br>
の ID を持つウィンドウの子ウィンドウを作成する。これによって、Vim を他のアプリ<br>
ケーションのプラグインとして使うことができる。これは完全にプログラマ向けのイン<br>
ターフェイスであり、Vim を正しく起動するアプリケーションの対応なくしては何の役<br>
にも立たない。<br>
<br>
<span class="PreProc">==============================================================================</span><br>
2. デフォルトエディタVim&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#vim-default-editor" name="vim-default-editor">vim-default-editor</a><br>
<br>
Vimをあるファイルタイプのデフォルトエディタにするには:<br>
1. Windowsのエクスプローラーを起動する<br>
2. ツール/フォルダオプション -&gt; ファイルタイプ (W2K + IE5.5)<br>
3. Vimを使用したい全てのファイルタイプに対して、gvimのパスを設定する。(拡張子<br>
&nbsp;&nbsp; の無いファイルタイプに対しては、ファイルタイプを指定するフィールドに3つのス<br>
&nbsp;&nbsp; ペースを置くことで対応できる)<br>
&nbsp;&nbsp; アクションの &quot;open&quot; に:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gvim &quot;%1&quot;</div>
&nbsp;&nbsp;&nbsp;ファイル名にスペースを含むファイルを正しく扱うためにクォート(&quot;)が必要。<br>
&nbsp;&nbsp; こういう方法もある:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gvim &quot;%L&quot;</div>
&nbsp;&nbsp;&nbsp;これにより幾つかの状況で、短い形式のファイル名(8.3形式)を避けることができ<br>
&nbsp;&nbsp; る。しかし、常に働くわけではない。<br>
<br>
ファイルをダブルクリックしてVimで開いた時には、Vimはそのファイルのディレクトリ<br>
へ移動する。<br>
<br>
Vimを全画面で起動したい時には、openのアクションとして次のものを使用する:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gvim -c &quot;simalt ~x&quot; &quot;%1&quot;</div>
<br>
新たにVimを違うディレクトリに置いた時(新しいバージョンを入手した時など)の、も<br>
う一つの方法は:<br>
1. Vimを使って開きたいファイルを選ぶ<br>
2.&nbsp;<span class="Special">&lt;Shift-F10&gt;</span>を押す<br>
3. メニューから &quot;アプリケーションから開く&quot; を選択する<br>
4. &quot;その他&quot; をクリック<br>
5. Vimの新しい位置を参照して、開くをクリックする。<br>
6. &quot;いつもこのアプリケーションを使う&quot; をチェックする<br>
7. OKをクリック<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#send-to-menu" name="send-to-menu">send-to-menu</a>&nbsp;<a class="Constant" href="gui_w32.html#sendto" name="sendto">sendto</a><br>
Vimを &quot;送る&quot; メニューに追加することもできる:<br>
1. Windowsのエクスプローラーを起動する。<br>
2. &quot;送る&quot; のためのディレクトリに移動する:<br>
&nbsp;&nbsp; C:\Users\%user%\AppData\Roaming\Microsoft\Windows\SendTo<br>
3. ファイル表示枠の上で右クリックして新規作成→ショートカット。<br>
4. ショートカットウィザードに従ってVIM/GVIMへのフルパスを指定。<br>
<br>
Vimにファイルを送ると、Vimはファイルのあるディレクトリに移動する。しかしいくつ<br>
かのWindowsのバージョンでは長いディレクトリ名は短い(MS-DOS)形式で表示されてし<br>
まうことに注意。これはWindowsの &quot;送る&quot; の仕組みによる制限である。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#notepad" name="notepad">notepad</a><br>
notepad.exe(メモ帳)をgvim.exeに置き換えてしまうこともできるが、これには副作用<br>
もある。いくつかのプログラムはnotepad.exeに依存していて、例えばファイルを印刷<br>
するために &quot;notepad -p&quot; を使っているからである。メモ帳(notepad)はそのままにし<br>
ておいて、Vimを起動するためのほかの方法を使ったほうが良い。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#win32-popup-menu" name="win32-popup-menu">win32-popup-menu</a><br>
もっと抜本的なアプローチは、右マウスボタンメニューに &quot;Edit with Vim&quot; という項<br>
目を追加するものである。これを使うとあらゆるファイルをVimで編集できるようにな<br>
る。<br>
<br>
これは上述のファイルの関連付けと共存することができる。ファイルの関連付けは、<br>
Vimで開始することを「デフォルトのアクション」にしてしまう点が違う。&quot;Edit with<br>
Vim&quot; メニュー項目を使うと、ダブルクリックで開ける既に存在するファイルの関連付<br>
けはそのままにして、したい時にはいつでもVimでファイルを編集することができる。<br>
例えば、&quot;*.mak&quot; はmakeプログラムに関連付けることができる。この場合、そのファイ<br>
ルをダブルクリックすればmakefileが実行されるし、&quot;Edit with Vim&quot; を選べば<br>
makefileを編集することができる。<br>
<br>
どんなファイルでも選択し、右クリックで &quot;Edit with gvim&quot; と呼ばれるメニューオプ<br>
ションを表示させることができる。このメニューオプションを選択すると、選択した<br>
ファイルがgvimによって開かれる。複数のファイルを選択した場合には、二つのメ<br>
ニューオプションが提示されるだろう:<br>
&quot;Edit with multiple gvims&quot;&nbsp;&nbsp;-- 1つのファイルにつき1つのgvimが起動される<br>
&quot;Edit with single gvim&quot;&nbsp;&nbsp;&nbsp;&nbsp; -- 選んだ全てのファイルが1つのgvimで開かれる<br>
さらに、もしもすでにgvimが起動しているなら:<br>
&quot;Edit with existing gvim&nbsp;&nbsp;&nbsp;&nbsp;-- すでに起動しているgvimでそのファイルの編集を開<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 始する。<br>
<br>
&quot;edit with existing Vim&quot; メニューはレジストリを設定することで無効化できる。<br>
HKLM\Software\Vim\Gvim に DisableEditWithExisting という名前のエントリを追加す<br>
ればよい。値は何でもよい。<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#install-registry" name="install-registry">install-registry</a><br>
&quot;install.exe&quot; プログラムを使用すれば、簡単に &quot;Edit with Vim&quot; メニュー項目を追<br>
加することができる。これはレジストリに幾つかの項目を書き加える。<br>
<br>
同じことを手動で行うこともできる。これは非常に複雑である! できればinstall.exe<br>
を使うことをオススメする。<br>
<br>
1. &quot;regedit&quot; でレジストリエディタを起動する。<br>
2. 次のキーを追加する:<br>
&nbsp;&nbsp;&nbsp;<span class="PreProc">キー&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; キーの名前&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;値</span><br>
&nbsp;&nbsp; HKEY_CLASSES_ROOT\CLSID\<span class="Special">{51EEE242-AD87-11d3-9C1E-0090278BBD99}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Special">{default}</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Vim Shell Extension<br>
&nbsp;&nbsp; HKEY_CLASSES_ROOT\CLSID\<span class="Special">{51EEE242-AD87-11d3-9C1E-0090278BBD99}</span>\InProcServer32<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Special">{default}</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Special">{path}</span>\gvimext.dll<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThreadingModel&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Apartment<br>
&nbsp;&nbsp; HKEY_CLASSES_ROOT\*\shellex\ContextMenuHandlers\gvim<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Special">{default}</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Special">{51EEE242-AD87-11d3-9C1E-0090278BBD99}</span><br>
&nbsp;&nbsp; HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Shell Extensions\Approved<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Special">{51EEE242-AD87-11d3-9C1E-0090278BBD99}</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vim Shell Extension<br>
&nbsp;&nbsp; HKEY_LOCAL_MACHINE\Software\Vim\Gvim<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Special">{path}</span>\gvim.exe<br>
&nbsp;&nbsp; HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Uninstall\vim 8.2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DisplayName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Vim 8.2: Edit with Vim popup menu entry<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UninstallString&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Special">{path}</span>\uninstall.exe<br>
<br>
&nbsp;&nbsp;&nbsp;<span class="Special">{path}</span>は実行可能ファイルのあるディレクトリパスに置き換える。<br>
&nbsp;&nbsp;&nbsp;<span class="Special">{default}</span>はキー自身の値なので、タイプしない。<br>
<br>
ポップアップメニューから &quot;Edit with Vim&quot; を削除するには、上記のレジストリ項目<br>
を削除すればよい。uninstall.exeプログラムは同じことをしてくれる。Windows標準<br>
の &quot;アプリケーションの追加と削除&quot; のリストの、エントリを使うこともできる。<br>
<br>
このエントリがファイルタイプの関連付けを抑制してしまうことに気がついたら、手動<br>
で関連付けをやり直す(上記を参考に、Windowsのエクスプローラーを使って)。これは<br>
Windows NTの幾つかのバージョンでだけ起こるらしい(Windowsのバグ?)。手続き:<br>
1. ファイルタイプの名前を見つける。これはレジストリエディタを起動し、<br>
&nbsp;&nbsp; \\HKEY_CLASSES_ROOTで拡張子を探すことで行える。<br>
2. Windowsエクスプローラーでは、表示→オプション→ファイルタイプ。リストの中か<br>
&nbsp;&nbsp; らファイルタイプを探し出し &quot;編集&quot; をクリック。アクションのリストで、デフォ<br>
&nbsp;&nbsp; ルトとして使用したいものを選択し(通常は &quot;開く&quot; アクション)、&quot;標準&quot; ボタンを<br>
&nbsp;&nbsp; クリックする。<br>
<br>
&quot;アプリケーションから開く&quot; コンテキストメニュー&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#win32-open-with-menu" name="win32-open-with-menu">win32-open-with-menu</a><br>
(&quot;Open With...&quot;)<br>
<br>
Vimのインストーラを使うならエクスプローラーのメニューの &quot;アプリケーションから<br>
開く&quot; にVimを加えるか選択することができる。これはVimでいろんなファイルを編集す<br>
るなら重要である。(不明瞭な理由で)全てのファイルには使えない。したがって &quot;Edit<br>
with Vim&quot; メニューの方が使いやすい。<br>
<br>
これを追加する理由の一つがインターネットエクスプローラーから直接ファイルを編集<br>
できるようにするためである。これを有効にするには &quot;Tools&quot; メニューから<br>
&quot;Internet Options...&quot; を選択し、出てきたダイアログウィンドウの &quot;Programs&quot; タ<br>
ブの &quot;HTML editor&quot; にVimを選択する。そこにVimがなければインストールは正常に完<br>
了していない。<br>
<br>
このスクリプトを使って手作業で設定できる。<br>
<br>
<span class="PreProc">----------------------------------------------------------</span><br>
REGEDIT4<br>
<br>
[HKEY_CLASSES_ROOT\Applications\gvim.exe]<br>
<br>
[HKEY_CLASSES_ROOT\Applications\gvim.exe\shell]<br>
<br>
[HKEY_CLASSES_ROOT\Applications\gvim.exe\shell\edit]<br>
<br>
[HKEY_CLASSES_ROOT\Applications\gvim.exe\shell\edit\command]<br>
@=&quot;c:\\vim\\vim82\\gvim.exe \&quot;%1\&quot;&quot;<br>
<br>
[HKEY_CLASSES_ROOT\.htm\OpenWithList\gvim.exe]<br>
<br>
[HKEY_CLASSES_ROOT\*\OpenWithList\gvim.exe]<br>
<br>
<span class="PreProc">----------------------------------------------------------</span><br>
<br>
&quot;c:\\vim\\vim82&quot; をgvim.exeが実際にある場所に変更すること。<br>
<br>
これをアンインストールするにはVimのアンインストーラを使うか &quot;regedit&quot; を使って<br>
手作業でレジストリエントリを削除する。<br>
<br>
<span class="PreProc">==============================================================================</span><br>
3. クリップボードを使う&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#gui-clipboard" name="gui-clipboard">gui-clipboard</a><br>
<br>
Windowsにはテキストを一時的に格納(コピー)し、取り出す(ペースト)できるクリップ<br>
ボードがある。Vimでは幾つかの方法でクリップボードに対応している。他のシステム<br>
については<a class="Identifier" href="gui.html#gui-selections">gui-selections</a>を参照。<br>
<br>
&quot;*レジスタにはクリップボードの内容が反映される。<a class="Identifier" href="gui.html#quotestar">quotestar</a><br>
<br>
<a class="Type" href="options.html#'clipboard'">'clipboard'</a>&nbsp;オプションに文字列 &quot;unnamed&quot; が含まれている時には、名前なしレジス<br>
タが同じになる。こうすることで、ヤンク(Vimにおけるコピー &quot;y&quot;)やペースト(Vimに<br>
おける貼り付け &quot;p&quot;)にクリップボードを、&quot;* を付けることなく使用できる。これが動<br>
作しない場合は&nbsp;<a class="Type" href="options.html#'clipboard'">'clipboard'</a>&nbsp;オプションに文字列 &quot;unnamedplus&quot; を使用する。<br>
<br>
デフォルトでは&nbsp;<a class="Type" href="options.html#'guioptions'">'guioptions'</a>&nbsp;に 'a' フラグは含まれていない。これはその操作を行っ<br>
た時にだけ、テキストがクリップボードへ送られることを意味している。単に視覚的に<br>
選択 (Visualモード)しただけではクリップボードには送られない。'a' フラグを加え<br>
れば、(Visualモードで選択するだけで)操作をせずにもクリップボードへ送られる。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#mswin.vim" name="mswin.vim">mswin.vim</a><br>
標準的なMS-Windowsの<span class="Special">CTRL-X</span>、<span class="Special">CTRL-C</span>および<span class="Special">CTRL-V</span>を使うには、<br>
$VIMRUNTIME/mswin.vimスクリプトを使用する。_vimrcファイルに次の一行を追加する:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source $VIMRUNTIME/mswin.vim</div>
<br>
<span class="Special">CTRL-C</span>がクリップボードへのコピーになってしまうので、操作を停止すること(無限<br>
ループに陥ったスクリプトを停止するなど)が、できなくなってしまう。代わりに<br>
<span class="Special">CTRL-Break</span>が使える。<br>
<br>
<span class="Special">CTRL-Z</span>&nbsp;がアンドゥになる。そのため、このキーでVimをサスペンドすることはできない。<br>
代わりに<a class="Identifier" href="starting.html#:suspend">:suspend</a>を使うこと(これがサポートされていればだが)。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#CTRL-V-alternative" name="CTRL-V-alternative">CTRL-V-alternative</a>&nbsp;<a class="Constant" href="gui_w32.html#CTRL-Q" name="CTRL-Q">CTRL-Q</a><br>
<span class="Special">CTRL-V</span>がペーストに使われてしまうので、矩形ビジュアル選択を開始することができな<br>
い。これには<span class="Special">CTRL-Q</span>を代用できる。挿入モードやコマンドラインモードにおいても、も<br>
ともとの<span class="Special">CTRL-V</span>の代わりに<span class="Special">CTRL-Q</span>を使用することができる。しかしターミナルで<span class="Special">CTRL-Q</span><br>
が制御のために使われる時はうまく機能しない。<br>
<br>
<span class="Todo">NOTE</span>: クリップボードのサポートにはまだかなりのバグがある。<a class="ExternalTaglink" href="https://vim-jp.org/vimdoc-en/todo.html#todo">todo</a>参照。<br>
<br>
<span class="PreProc">==============================================================================</span><br>
4. シェルコマンド&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#gui-shell-win32" name="gui-shell-win32">gui-shell-win32</a><br>
<br>
Vimは外部コマンドを実行するのに、どんなコマンドでも実行できるようにするために<br>
Vimとは別個のウィンドウを使用する。外部コマンドはちょうどDOSプロンプトから実行<br>
されるように、独自の実行環境を獲得する。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#win32-vimrun" name="win32-vimrun">win32-vimrun</a><br>
外部コマンドの実行は &quot;vimrun&quot; コマンドを用いて間接的に行われる。これが働くため<br>
には &quot;vimrun.exe&quot; コマンドが実行パスになければならない。そうでなければVimの実<br>
行ファイルと同じディレクトリになければならない。&quot;vimrun&quot; を見つけることができ<br>
なければ、コマンドは直接実行され、そのため外部コマンドの実行が終了するとすぐに<br>
DOSウィンドウが閉じられる。<br>
<span class="Todo">警告:</span>&nbsp;もしも &quot;X&quot; ボタンでこのウィンドウを閉じてしまい、強制終了することを確認<br>
するウィンドウでアプリケーションを本当に終了してしまうと、Vimも一緒に強制終了<br>
してしまう!&nbsp;&nbsp;(&quot;:!start&quot; で非同期的に起動されたアプリケーションには、これは当て<br>
はまらない)<br>
<br>
コントロールパネルの &quot;コンソール&quot; によって設定された内容がデフォルトで使用され<br>
る。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#win32-!start" name="win32-!start">win32-!start</a><br>
通常、Vimはコマンドの実行が終了するのを待つ(これは多くのシェルコマンドの出力を<br>
Vimが取り込んで使用できるようにするため)。Vimがプログラムを実行した後、その終<br>
了を待たないように望むのならば、次の構文を使用することができる:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:!start [/min] {command}</div>
&quot;/min&quot; 引数を指定すると、ウィンドウは最小化される。<br>
<br>
<span class="PreProc">==============================================================================</span><br>
5. 特別な色&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#win32-colors" name="win32-colors">win32-colors</a><br>
<br>
Win32では、通常のDOSでの色が使用される。<a class="Identifier" href="os_dos.html#dos-colors">dos-colors</a>を参照。<br>
<br>
付け加えて、システムが構成している色を使用することができる。それらはSys_XXXと<br>
して知られ、XXXの部分は下のリストに示される、割り当てられているシステムカラー<br>
名である(完全な解説はWin32の文章を参照)。大文字小文字は区別されない。<span class="Todo">Note</span>:<br>
<br>
Sys_3DDKShadow&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sys_3DFace&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sys_BTNFace<br>
Sys_3DHilight&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sys_3DHighlight&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sys_BTNHilight<br>
Sys_BTNHighlight&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sys_3DLight&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sys_3DShadow<br>
Sys_BTNShadow&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sys_ActiveBorder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sys_ActiveCaption<br>
Sys_AppWorkspace&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sys_Background&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sys_Desktop<br>
Sys_BTNText&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sys_CaptionText&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sys_GrayText<br>
Sys_Highlight&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sys_HighlightText&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sys_InactiveBorder<br>
Sys_InactiveCaption&nbsp;&nbsp;&nbsp;&nbsp; Sys_InactiveCaptionText&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sys_InfoBK<br>
Sys_InfoText&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sys_Menu&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sys_MenuText<br>
Sys_ScrollBar&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sys_Window&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sys_WindowFrame<br>
Sys_WindowText<br>
<br>
恐らく一番便利な値はこれらだろう<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sys_Window&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;通常のウィンドウの背景の色<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sys_WindowText&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;通常のウィンドウの文字の色<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sys_Highlight&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 選択されたテキストの背景の色<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sys_HighlightText&nbsp;&nbsp; 選択されたテキストの文字の色<br>
<br>
他にもこの様な色も存在する:<br>
Gray, Grey, LightYellow, SeaGreen, Orange, Purple, SlateBlue, Violet,<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html" name="rgb.txt">rgb.txt</a><br>
付け加えて、デフォルトのカラーリストで定義される色も使うことができる。詳細は<br>
<a class="Identifier" href="syntax.html#:colorscheme">:colorscheme</a>&nbsp;を参照のこと。これらの色は以前は $VIMRUNTIME/rgb.txt で定義され<br>
ていたもので、現在は $VIMRUNTIME/colors/lists/default.vim にて初期化された値が<br>
<a class="Identifier" href="eval.html#v:colornames">v:colornames</a>&nbsp;にある。<br>
<br>
<span class="PreProc">==============================================================================</span><br>
6. ダイアログとブラウズ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#gui-w32-dialogs" name="gui-w32-dialogs">gui-w32-dialogs</a>&nbsp;<a class="Constant" href="gui_w32.html#dialog" name="dialog">dialog</a><br>
<br>
コンソールバージョンから受け継がれる伝統的なインターフェイスはもちろん、さらに<br>
Win32 GUIでは幾つかの操作に見慣れたWindowsのコンポーネントを使用することができ<br>
る。<br>
<br>
<br>
6.1 ダイアログ<br>
<br>
その他のバージョンではコンソールベースで行われていた &quot;confirm&quot; ファミリ(すなわ<br>
ち&nbsp;<a class="Type" href="options.html#'confirm'">'confirm'</a>&nbsp;オプションと<a class="Identifier" href="editing.html#:confirm">:confirm</a>コマンドと<a class="Identifier" href="builtin.html#confirm()">confirm()</a>関数)で、GUIベースのダ<br>
イアログが表示される。<a class="Type" href="options.html#'guioptions'">'guioptions'</a>&nbsp;の 'c' フラグでこれを変更できる。<br>
<br>
<br>
6.2 ファイルブラウザー<br>
<br>
ファイルを編集するコマンドの前に &quot;:browse&quot; を付けると、存在するファイルを選択<br>
するためのウィンドウ選択ダイアログが使用される。<a class="Identifier" href="editing.html#:browse">:browse</a>を参照。<br>
<br>
<br>
6.3 切取メニュー<br>
<br>
Win32 GUI版ではMotifの「切取メニュー」をエミュレートする。個々のメニューの最上<br>
位には、小さな「切り取り線」のグラフィックスが存在する。これを選択すると同じメ<br>
ニューのエントリがある、フローティングウィンドウが作成される。フローティングメ<br>
ニューを使用すれば、いちいちメニューバーに移動することなく、オリジナルのメ<br>
ニューの(サブメニューも含めた)項目にアクセスすることができる。<br>
これはサブメニューの奥の方のコマンドを頻繁に使用するときに非常に便利。<br>
切取メニューは好きなところに配置し、常にVimのメインウィンドウよりも手前に表示<br>
される。普通に閉じることで取り除くこともできる;もちろんVimを終了すれば自動的に<br>
それらも閉じられる。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#:tearoff" name=":tearoff">:tearoff</a>&nbsp;<a class="Constant" href="gui_w32.html#:te" name=":te">:te</a><br>
:te[aroff]&nbsp;<span class="Special">{name}</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Special">{name}</span>というメニューを切り取る。指定されたメニューは少<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;なくとも一つ以上のサブエントリを持たねばないが、メ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ニューバーに表示されている必要は無い。<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="Identifier" href="gui.html#win32-hidden-menus">win32-hidden-menus</a>)を参照。<br>
<br>
例:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:tearoff ファイル(F)</div>
&quot;ファイル&quot; メニューが(あれば)切取メニューとして表示される。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:amenu ]Toolbar.Make&nbsp;&nbsp;&nbsp;&nbsp;:make&lt;CR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:tearoff ]Toolbar</div>
メインのメニューバーには存在しないフローティングメニューを作成する。<br>
<br>
']' で始まるメニューは表示されないことに注意。<br>
<br>
<span class="PreProc">==============================================================================</span><br>
7. コマンドライン引数&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#gui-w32-cmdargs" name="gui-w32-cmdargs">gui-w32-cmdargs</a><br>
<br>
コマンドライン引数はコンソール版と同じ挙動となる。<a class="Identifier" href="os_win32.html#win32-cmdargs">win32-cmdargs</a>&nbsp;を参照。<br>
<br>
<span class="PreProc">==============================================================================</span><br>
8. その他色々&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#gui-w32-various" name="gui-w32-various">gui-w32-various</a><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#gui-w32-printing" name="gui-w32-printing">gui-w32-printing</a><br>
&quot;ファイル/印刷&quot; メニューはシンタックスハイライトを使って印刷する。<a class="Identifier" href="print.html#:hardcopy">:hardcopy</a><br>
を参照すること。もしもテキストを装飾なしで印刷したいのなら、デフォルトのプリン<br>
タがインストールされていれば次のようにできるだろう。<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:w &gt;&gt;prn</div>
<br>
Vimでは多くのMS-Windows標準の機能をサポートしている。それらの幾つかは別の場所<br>
で説明されている:&nbsp;<a class="Identifier" href="options.html#'mouse'">'mouse'</a>、<a class="Identifier" href="gui.html#win32-hidden-menus">win32-hidden-menus</a>を参照。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#drag-n-drop-win32" name="drag-n-drop-win32">drag-n-drop-win32</a><br>
Vimのウィンドウに1つもしくは複数のファイルをドラッグ&amp;ドロップすることができ、<br>
それらは普通に開かれる。<a class="Identifier" href="gui.html#drag-n-drop">drag-n-drop</a>を参照。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#:simalt" name=":simalt">:simalt</a>&nbsp;<a class="Constant" href="gui_w32.html#:sim" name=":sim">:sim</a><br>
:sim[alt]&nbsp;<span class="Special">{key}</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Alt と&nbsp;<span class="Special">{key}</span>&nbsp;の同時押しをシミュレートする。<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{Win32バージョンだけの機能}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Todo">Note</span>: &quot;:si&quot; は &quot;i&quot; フラグ付きの &quot;:s&quot; になる。<br>
<br>
通常、Vimでは使用可能なマッピングを増やすために、Alt-<span class="Special">&lt;Key&gt;</span>の全ての組み合わせを<br>
使うことができる。これはメニューにアクセスするためのAltキーの標準的な使い方と<br>
衝突する。<br>
標準的な振る舞いをさせるための近道は、<a class="Type" href="options.html#'winaltkeys'">'winaltkeys'</a>&nbsp;オプションに &quot;yes&quot; を設定す<br>
ることである。しかしこうするとAltを使用したマッピングは一切使えなくなる。<br>
もう一つの方法は&nbsp;<a class="Type" href="options.html#'winaltkeys'">'winaltkeys'</a>&nbsp;に &quot;menu&quot; を指定することである。マッピングされて<br>
いないALTキーだけが、メニューのショートカットとしてWindowsに解釈される。だが、<br>
現在の状態に依存することは許さない。<br>
これを回避するために、(<a class="Type" href="options.html#'winaltkeys'">'winaltkeys'</a>&nbsp;が &quot;yes&quot; でない時に) :simaltコマンドで、<br>
WindowsのスタイルでAltキーを押すふりを、Vimにさせることができる。これを使って<br>
Windows標準のアクションを実行するための、Altキーの組み合わせ(ほかのものでも)を<br>
マッピングすることができる。いくつか例を示そう:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:map &lt;M-f&gt; :simalt f&lt;CR&gt;</div>
これでAlt-Fを押すとキーストロークのAlt→Fがシミュレートされ、'ファイル(F)' メ<br>
ニュー(Menu.vimで定義される)が表示される。<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:map &lt;M-Space&gt; :simalt ~&lt;CR&gt;</div>
このマッピングによりAlt-SpaceでVimウィンドウのシステムメニューが表示される。<br>
'~' はsimaltにおいて文字<span class="Special">&lt;Space&gt;</span>を表現するのに使われることに注意。<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:map &lt;C-n&gt; :simalt ~n&lt;CR&gt;</div>
Control-<span class="Special">N</span>に、Alt-Spaceに<span class="Special">N</span>を続けるマッピングを施す。これはシステムメニュー経由<br>
でVimのウィンドウを最小化する。<br>
<br>
これらのキーは使用している言語によって異なることがある。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#intellimouse-wheel-problems" name="intellimouse-wheel-problems">intellimouse-wheel-problems</a><br>
インテリマウスのホイールを使用すると、Vimは入力を受け付けなくなることがある。<br>
次の場所へ行き:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;コントロールパネル - マウス - ホイール - スクロール - 例外<br>
<br>
アプリケーションのリストにgvimを追加する。この問題はIntellimouseのドライババー<br>
ジョン2.2を使用し、&quot;ユニバーサルスクロール&quot; を有効にしている時にだけ起こる。<br>
<br>
XPM サポート&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="gui_w32.html#w32-xpm-support" name="w32-xpm-support">w32-xpm-support</a><br>
<br>
GVim は、MS-Windows で XPM ファイルのサポート付きでビルドすることができる。<br>
<a class="Identifier" href="various.html#+xpm_w32">+xpm_w32</a><br>
詳細は Make_mvc.mak ファイルを見て、XPM で検索すること。<br>
<br>
XPM サポートが動作するか試すには、以下を行うこと:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:help<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:let runtime = escape($VIMRUNTIME, ' \')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:exe 'sign define vimxpm icon=' .. runtime .. '\\vim16x16.xpm'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:exe 'sign place 1 line=1 name=vimxpm file=' .. expand('%:p')</div>
<br>
github から vim16x16.xpm ファイルを入手する必要があるかもしれない:<br>
<span class="Constant"><a href="https://github.com/vim/vim/blob/master/runtime/vim16x16.xpm">https://github.com/vim/vim/blob/master/runtime/vim16x16.xpm</a></span><br>
<br>
<br>
&nbsp;vim:tw=78:sw=4:ts=8:noet:ft=help:norl:<br>
</div>
