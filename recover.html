<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>Vim documentation: recover</title>
<meta name="Generator" content="Vim/7.3">
<meta name="plugin-version" content="vim7.3_v10">
<meta name="syntax" content="help">
<meta name="settings" content="no_pre,use_css,expand_tabs">
<link rel="stylesheet" href="style.css" type="text/css" />
</head>
<body>
<div id="cse-search-form" style="float:right;">Loading</div>
<script src="//www.google.com/jsapi" type="text/javascript"></script>
<script type="text/javascript"> 
  google.load("search", "1", {language : "ja"});
  google.setOnLoadCallback(function() {
    var customSearchControl = new google.search.CustomSearchControl("001325159752250591701:65aunpq8rlg");
    customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
    var options = new google.search.DrawOptions();
    options.enableSearchboxOnly("http://www.google.com/cse?cx=001325159752250591701:65aunpq8rlg");
    customSearchControl.draw("cse-search-form", options);
  }, true);
</script>
<link rel="stylesheet" href="//www.google.com/cse/style/look/default.css" type="text/css" />

<a name="top"></a><h1>Vim documentation: recover</h1>
<a href="index.html">main help file</a>
<hr>
<a class="Constant" href="recover.html" name="recover.txt">*recover.txt*</a>&nbsp;&nbsp; For&nbsp;<span class="Identifier">Vim バージョン 7.3.</span>&nbsp;&nbsp;Last change: 2010 Jul 20<br>
<div><br></div>
<div><br></div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Identifier">VIM REFERENCE MANUAL&nbsp;&nbsp;&nbsp;&nbsp;by Bram Moolenaar</span><br>
<div><br></div>
<div><br></div>
クラッシュ後のリカバリー&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="recover.html#crash-recovery" name="crash-recovery">*crash-recovery*</a><br>
<div><br></div>
あなたが明日の朝までに終わらせなければならない文書のタイピングに数時間を費や<br>
していたとき、悲劇があなたを襲う。: コンピュータがクラッシュした。<br>
<div><br></div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;慌てないで!<br>
<div><br></div>
あなたはVimがファイルの内容を蓄えていたファイルから、ほとんどの変更を回復でき<br>
る。たいていの場合、あなたの仕事は1コマンドで回復できる。<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vim -r filename<br>
<div><br></div>
1. スワップファイル&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Identifier" href="recover.html#swap-file">|swap-file|</a><br>
2. リカバリー&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Identifier" href="recover.html#recovery">|recovery|</a><br>
<div><br></div>
<span class="PreProc">==============================================================================</span><br>
1. スワップファイル&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="recover.html#swap-file" name="swap-file">*swap-file*</a><br>
<div><br></div>
Vimは変更した箇所をスワップファイルに蓄える。編集を開始したオリジナルのファイ<br>
ルとスワップファイルから、あなたのした作業は回復することができる。<br>
<div><br></div>
現在使用しているスワップファイルの名前は、次のコマンドで確認できる:<br>
<div><br></div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:sw[apname]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="recover.html#:sw" name=":sw">*:sw*</a>&nbsp;<a class="Constant" href="recover.html#:swapname" name=":swapname">*:swapname*</a><br>
<div><br></div>
スワップファイルの名前は、普通は編集中のファイルと同じで、拡張子が&quot;.swp&quot;のもの<br>
になる。<br>
- UNIXでは、スワップファイルは編集中のファイルと同じディレクトリ内に作られ、<br>
&nbsp;&nbsp;'.'が名前の前につけられる。これはディレクトリ表示からスワップファイルを隠す<br>
&nbsp;&nbsp;ためである。<br>
- MS-DOS マシンで、<a class="Type" href="options.html#'shortname'">'shortname'</a>&nbsp;オプションがオンのときは、オリジナルファイルの<br>
&nbsp;&nbsp;'.'は'_'に置き換えられる。<br>
- このファイルがすでに存在すると(たとえば、クラッシュから復帰した場合)、注意が<br>
&nbsp;&nbsp;表示され、違った拡張子、&quot;.swo&quot;、&quot;.swn&quot;、などが用いられる。<br>
- 存在しているファイルは決して上書きされない。<br>
- スワップファイルはVimが編集を終えるとすぐに削除される。<br>
<div><br></div>
技術情報:&nbsp;&nbsp;'.'から'_'への置換はMS-DOS互換のファイルシステム(例、crossdos、<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; multidos)での問題を避けるためである。もしVimがMS-DOSライクなファイ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ルシステムを探知すると、<a class="Type" href="options.html#'shortname'">'shortname'</a>&nbsp;オプションと同じ効果を持つフラ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; グが設定される。このフラグは違うファイルの編集を始めたときにリセッ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; トされる。<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="recover.html#E326" name="E326">*E326*</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; もし&quot;.swp&quot;ファイルがすでに存在すると、同名のファイルが存在しなくな<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; るか、&quot;.saa&quot;となるまで最後の文字をひとつ前の文字に戻す。&quot;.saa&quot;まで<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 存在するときは、スワップファイルは作られない。<br>
<div><br></div>
<a class="Type" href="options.html#'directory'">'directory'</a>&nbsp;オプションを設定することによって、スワップファイルを、編集している<br>
ファイルとは別の場所に置くこともできる。<br>
利点:<br>
- ディレクトリが&quot;.swp&quot;ファイルで汚染されることがない。<br>
-&nbsp;<a class="Type" href="options.html#'directory'">'directory'</a>&nbsp;が別パーティションにある場合、ファイルのあるファイルシステムが<br>
&nbsp;&nbsp;(クラッシュで)損傷を受けるリスクが減る。<br>
欠点:<br>
- 別ディレクトリの同一名のファイルで名前の衝突を生じうる(Vimはパス名の比較でそ<br>
&nbsp;&nbsp;れを避けようとするが)。<br>
&nbsp;&nbsp;これによって偽の注意メッセージが表示される。<br>
- あなたがホームディレクトリで作業をしていて、他の誰かが同じファイルを編集しよ<br>
&nbsp;&nbsp;うとしたとき、その人はあなたのスワップファイルに気付かないし、注意のメッセー<br>
&nbsp;&nbsp;ジも表示されない。<br>
Amigaでは、回復可能なramディスクを使えるが、それが100％働くという保証はない。<br>
スワップファイルを通常のramディスク(AmigaではRAM:など)に置いたり、リブートに<br>
よって消されてしまう場所(Unixの/tmpなど)に置くことは無意味であり、クラッシュに<br>
よってスワップファイルは失われてしまう。<br>
<div><br></div>
スワップファイルを固定ディスクに置きたいときは、あなたの.vimrcファイルに次に示<br>
す様なコマンドを入れる:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:set dir=dh2:tmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Amigaの場合)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:set dir=~/tmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Unixの場合)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:set dir=c:\\tmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MS-DOS and Win32の場合)<br>
これらの設定はフロッピー上で編集作業をしているときには負担となる。もちろん、こ<br>
の様な設定で作業をするならば、&quot;tmp&quot;ディレクトリを作らねばならない。<br>
<div><br></div>
読取専用属性のファイルに対しては、スワップファイルは使用されない。ファイルが大<br>
きくなければ、<a class="Type" href="options.html#'maxmem'">'maxmem'</a>や<a class="Type" href="options.html#'maxmemtot'">'maxmemtot'</a>で与えられた量より多くのメモリを使用するこ<br>
とはない。読取専用属性のファイルについて何らかの変更が加えられたとき、スワップ<br>
ファイルは無条件に作成される。<br>
<div><br></div>
スワップファイルの作成を避けるために<a class="Type" href="options.html#'swapfile'">'swapfile'</a>オプションをリセットできる。<br>
<div><br></div>
<span class="PreProc">既存のスワップファイルを削除する</span><br>
<div><br></div>
ユーザーマニュアルの<a class="Identifier" href="usr_11.html#11.3">|11.3|</a>をご覧ください。<br>
<div><br></div>
<div><br></div>
<span class="PreProc">スワップファイルの更新</span><br>
<div><br></div>
スワップファイルは200文字を打ち込むか、4秒間何もしなかったときに更新される。こ<br>
れはバッファが変更されたときのみ行われ、動き回っているだけでは行われない。なぜ<br>
常に更新が行われないかといえば、それは通常の作業が大幅に遅くなるからである。<br>
200文字の設定は<a class="Type" href="options.html#'updatecount'">'updatecount'</a>で、時間の設定は<a class="Type" href="options.html#'updatetime'">'updatetime'</a>で変更できる。時間はミ<br>
リ秒単位で与えられる。スワップファイルに書き込んだ後で、Vimはファイルとディス<br>
クの同期を取る。これにはしばらく時間が掛かる(ビジーなUnixシステムにおいては特<br>
に時間がかかる)。もしこれを行って欲しくなければ、<a class="Type" href="options.html#'swapsync'">'swapsync'</a>オプションに空文字<br>
列を設定すればよい。作業の成果を失う危険性は増すが。いくつかの非Unixシステム<br>
(MS-DOS、Amigaなど)においては、スワップファイルはまったく書き込まれなくなるだ<br>
ろう。<br>
<div><br></div>
スワップファイルへの書き込みを望まないなら、<a class="Type" href="options.html#'updatecount'">'updatecount'</a>を0に設定することで行<br>
われなくなる。Vimを&quot;-n&quot;オプションで起動することで、同じ結果が得られる。書き込<br>
みは<a class="Type" href="options.html#'updatecount'">'updatecount'</a>を非0にすることでまた行われるようになる。これを行ったときはス<br>
ワップファイルが全てのバッファに対して作られる。しかし、<a class="Type" href="options.html#'updatecount'">'updatecount'</a>を0に設定<br>
したときは、存在しているスワップファイルは消されることはなく、次に開かれたファ<br>
イルから有効になる。<br>
<div><br></div>
行った編集がスワップファイルに書きこまれたかを確認するには、次のコマンドを使用<br>
する:<br>
<div><br></div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="recover.html#:pre" name=":pre">*:pre*</a>&nbsp;<a class="Constant" href="recover.html#:preserve" name=":preserve">*:preserve*</a><br>
:pre[serve]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 全てのバッファの全てのテキストをスワップファイルに書き<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;込む。回復のためにオリジナルが必要とされることはなくな<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;る。<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;このコマンドはカレントバッファにあるフラグを設定する。<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;また、<a class="Type" href="options.html#'cpoptions'">'cpoptions'</a>&nbsp;にフラグ '&amp;' が入っているならば、Vim<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;が終了するとき、このバッファのスワップファイルは削除さ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;れず、バッファは読み込まれた状態のままになる。<a class="Identifier" href="options.html#cpo-&">|cpo-&amp;|</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Special">{Vi: might also exit}</span><br>
<div><br></div>
Vimのスワップファイルは最初の6文字で認識される: &quot;b0VIM&quot;。<br>
この後に&quot;3.0&quot;などのバージョン番号が続く。<br>
<div><br></div>
<div><br></div>
<span class="PreProc">リンクとシンボリックリンク</span><br>
<div><br></div>
Unix では同一のファイルに2つの名前をつけることができる。それはハードリンクまた<br>
はシンボリックリンク(symlink)を使って行う。<br>
<div><br></div>
ハードリンクの場合、 Vim はそのファイルにつけられた他の名前を知ることができな<br>
い。そのため、スワップファイルの名前は、そのファイルを開くときに使った名前に基<br>
づいてつけられる。<br>
そのファイルが別の名前でも開かれているかどうかのチェックは行わない。他のスワッ<br>
プファイルを検出することはできないからである(ハードディスク全てを検索するとい<br>
う方法は除く。それはとても遅くなるから)。<br>
<div><br></div>
シンボリックリンクの場合、Vim はそのリンクが指す実際のファイルを見つけられる。<br>
スワップファイルの名前は実際の名前に基づいてつけられる。よって、ユーザがどんな<br>
名前でそのファイルを開いたかは関係なく、スワップファイル名は同一になる。しかし<br>
次のような例外がある:<br>
- シンボリックリンクがなんらかの形でループになっているとき、エラーメッセージ<br>
<span class="Statement">&nbsp;&nbsp;</span><a class="Constant" href="recover.html#E773" name="E773">*E773*</a>&nbsp;が表示され、変更されていないファイル名が使われる。普通にファイルを保<br>
&nbsp;&nbsp;存することはできない。<br>
<div><br></div>
<span class="PreProc">==============================================================================</span><br>
2. リカバリー&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="recover.html#recovery" name="recovery">*recovery*</a><br>
<div><br></div>
基本的なファイルの回復方法はユーザーマニュアルの<a class="Identifier" href="usr_11.html">|usr_11.txt|</a>をご覧ください。<br>
<div><br></div>
ファイルを回復するためのもうひとつの方法は、Vimを起動して&quot;:recover&quot;コマンドを<br>
使うことである。<br>
これはVimを起動したときに&quot;ATTENTION: Found a swap file ...&quot;というメッセージを<br>
受け取ったときには便利である。その場合には&quot;:recover&quot;というコマンドひとつで全て<br>
が済む。<br>
recoverコマンドにはファイル名かスワップファイル名を渡すことができる:<br>
<div><br></div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="recover.html#:rec" name=":rec">*:rec*</a>&nbsp;<a class="Constant" href="recover.html#:recover" name=":recover">*:recover*</a><br>
:rec[over]&nbsp;<span class="Special">[file]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; スワップファイルから[file]を回復するよう試みる。もし<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Special">[file]</span>が与えられていない場合は、現在のバッファの名前が<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;用いられる。現在のバッファの内容は失われる。このコマン<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ドはバッファが修正を加えられている場合に失敗する。<br>
<div><br></div>
:rec[over]!&nbsp;<span class="Special">[file]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;:recover&quot;と同じだが、現在のバッファに対するどんな変更<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;も失われる。<br>
<div><br></div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="recover.html#E312" name="E312">*E312*</a>&nbsp;<a class="Constant" href="recover.html#E309" name="E309">*E309*</a>&nbsp;<a class="Constant" href="recover.html#E310" name="E310">*E310*</a><br>
Vimはスワップファイルが何らかの理由で壊れているときに、いくつかの対処を提供す<br>
る。Vimが見つかったものに疑問を持った場合、エラーメッセージが与えられ、&quot;???&quot;と<br>
いうテキストが一緒に行に挿入される。回復中にエラーメッセージを受け取ったら、<br>
&quot;???&quot;を検索することによってどこに問題があったかを知ることができる。必要なテキ<br>
ストを得るためには、カットやペーストを必要とするかもしれない。<br>
<div><br></div>
ほとんどは&quot;???LINES MISSING&quot;のようなものです。これはVimがそのテキストをオリジ<br>
ナルのファイルから読み込めないことを示します。これはシステムがクラッシュした時<br>
にファイルが正しくディスクに書き込まれなかったときに起こります。<br>
<div><br></div>
オリジナルを上書きしたり、スワップファイルを削除する前に、回復が成功したことを<br>
確認すること。回復されたファイルをどこか別の場所に保存して、<a class="Type" href="options.html#'diff'">'diff'</a>によって変更<br>
を加えた箇所が、ちゃんと回復されたファイルに入っているか調べてみるとよい。また<br>
は&nbsp;<a class="Identifier" href="diff.html#:DiffOrig">|:DiffOrig|</a>&nbsp;を使う。<br>
<div><br></div>
回復が成功したと確信したら、スワップファイルを削除する。そうしないと、&quot;.swp&quot;が<br>
存在するというメッセージが表示されつづけることになる。<br>
<div><br></div>
<span class="Special">{Vi: 違う方法で回復し、回復できそうなときはメールが送られる}</span><br>
<div><br></div>
<div><br></div>
暗号化とスワップファイル&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="recover.html#:recover-crypt" name=":recover-crypt">*:recover-crypt*</a><br>
<div><br></div>
テキストファイルが暗号化されているときはスワップファイルも暗号化されます。これ<br>
はリカバリーを多少複雑にします。スワップファイルからリカバリーするときにそれが<br>
暗号化されていた場合、一つか二つの秘密鍵を入力する必要があるでしょう。<br>
<div><br></div>
テキストファイルが存在しない場合は入力する必要のある秘密鍵はスワップファイル用<br>
の一つだけです。<br>
<div><br></div>
テキストファイルが存在する場合、そのファイルはスワップファイルとは別の方法で復<br>
号する必要があるかもしれません。秘密鍵を二つ入力する必要があります:<br>
<div><br></div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="PreProc">Need encryption key for &quot;/tmp/tt&quot;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="PreProc">Enter encryption key: ******</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="PreProc">&quot;/tmp/tt&quot; [crypted] 23200L, 522129C</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="PreProc">Using swap file &quot;/tmp/.tt.swp&quot;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="PreProc">Original file &quot;/tmp/tt&quot;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="PreProc">Swap file is encrypted: &quot;/tmp/.tt.swp&quot;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="PreProc">If you entered a new crypt key but did not write the text file,</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="PreProc">enter the new crypt key.</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="PreProc">If you wrote the text file after changing the crypt key press enter</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="PreProc">to use the same key for text file and swap file</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="PreProc">Enter encryption key:&nbsp;</span><br>
<div><br></div>
二つの状況が考えられます:<br>
<div><br></div>
1. 暗号化キーが変更されなかったか、キーが変更された後でファイルが保存された場<br>
&nbsp;&nbsp; 合。秘密鍵を二回入力する必要があります。二回目に入力するときは単にエンター<br>
&nbsp;&nbsp; を押してください。そうするとテキストファイルとスワップファイルの両方に同じ<br>
&nbsp;&nbsp; キーが使用されます。<br>
2. 新しい暗号化キーを入力したが、ファイルは保存されなかった場合。スワップファ<br>
&nbsp;&nbsp; イルには新しいキーが使用されていますが、テキストファイルは古いキーで暗号化<br>
&nbsp;&nbsp; されたままになっています。二回目にキーを入力するときに新しい方のキーを入力<br>
&nbsp;&nbsp; してください。<br>
<div><br></div>
<span class="Todo">Note</span>: リカバリー実行後にはスワップファイルのキーがテキストファイルに使用されま<br>
す。したがって、ファイルを書き込んだ後は新しいキーを使用する必要があります。<br>
<div><br></div>
<div><br></div>
&nbsp;vim&#0058;tw=78:ts=8:ft=help:norl:<br>
<hr>
<a href="#top">top</a> - <a href="index.html">main help file</a><br>

<div style="text-align:right;">
<a href="https://github.com/vim-jp/vimdoc-ja">Vim日本語ドキュメント</a><br>
</div>
</body>
</html>
