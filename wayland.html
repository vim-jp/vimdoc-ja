---
layout: vimdoc
helpname: 'wayland'
---
<div id='vimCodeElement'>
<a class="Constant" href="wayland.html" name="wayland.txt">wayland.txt</a>&nbsp;&nbsp; For&nbsp;<span class="Identifier">Vim バージョン 9.1.</span>&nbsp;&nbsp;Last change: 2025 Aug 20<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Identifier">VIMリファレンスマニュアル&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; by Bram Moolenaar</span><br>
<br>
<br>
Wayland プロトコルのサポート&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="wayland.html#wayland" name="wayland">wayland</a><br>
<br>
1. Wayland の役立つ情報&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Identifier" href="wayland.html#wayland-useful">wayland-useful</a><br>
2. Wayland セレクション&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Identifier" href="wayland.html#wayland-selections">wayland-selections</a><br>
<br>
<span class="PreProc">==============================================================================</span><br>
1. Wayland の役立つ情報&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="wayland.html#wayland-useful" name="wayland-useful">wayland-useful</a><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="wayland.html#wayland-seat" name="wayland-seat">wayland-seat</a><br>
Wayland のクリップボードなどの機能を使用するには、シートが必要である。Wayland<br>
シートは、キーボード、ポインター、タッチデバイスで構成される。使用するシートは<br>
<a class="Type" href="options.html#'wlseat'">'wlseat'</a>&nbsp;オプションで設定できる。これは、同じ Wayland セッションで複数の<br>
Wayland シートを使用する場合にのみ役立つ。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="wayland.html#wayland-gui" name="wayland-gui">wayland-gui</a><br>
<a class="Identifier" href="gui_x11.html#gui-wayland">gui-wayland</a>&nbsp;を参照。GUI 使用時、Vim はクリップボードへのアクセスに GTK など<br>
のツールキットを使用し、Wayland 経由ではアクセスしない。これは&nbsp;<a class="Identifier" href="eval.html#v:clipmethod">v:clipmethod</a><br>
変数で確認できる。GUI 実行時にはこの変数は &quot;none&quot; になる。<br>
<br>
Wayland のコマンド:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="wayland.html#:wlrestore" name=":wlrestore">:wlrestore</a>&nbsp;<a class="Constant" href="wayland.html#:wl" name=":wl">:wl</a><br>
:wl[restore]&nbsp;<span class="Special">[display]</span>&nbsp;&nbsp;Wayland コンポジタへの接続を再初期化する。Wayland コン<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ポジタの再起動後も Vim を screen/tmux セッションで実行<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;し続ける場合に便利である。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Special">[display]</span>&nbsp;は、環境変数 $WAYLAND_DISPLAY の形式（例:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;wayland-0&quot;）で指定する必要がある。<span class="Special">[display]</span>&nbsp;を省略し<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;た場合は、このコマンドの前回実行時に使用された値と同じ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;値を使用して接続を再初期化する。<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;値が指定されていない場合は、環境変数 $WAYLAND_DISPLAY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;の値が使用される。また、<a class="Identifier" href="eval.html#v:clipmethod">v:clipmethod</a>&nbsp;も更新される。<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Special">{Vimが&nbsp;</span><a class="Identifier" href="various.html#+wayland">+wayland</a><span class="Special">&nbsp;機能付きでコンパイルされたときのみ有</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Special">効}</span><br>
<br>
Wayland のエラー:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="wayland.html#E1548" name="E1548">E1548</a><br>
Vim は Wayland コンポジタとの通信に失敗した。これは Wayland コンポジタのプロセ<br>
スが強制終了したことが原因である可能性がある。再接続するには&nbsp;<a class="Comment" href="wayland.html#:wlrestore">:wlrestore</a>&nbsp;コマ<br>
ンドを試すこと。<br>
<br>
<span class="PreProc">==============================================================================</span><br>
2. Wayland セレクション&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="wayland.html#wayland-selections" name="wayland-selections">wayland-selections</a><br>
<br>
Vim は、現在の Wayland セレクションにアクセスするための<br>
wlr-data-control-unstable-v1 プロトコルと ext-data-control-v1 プロトコルをサ<br>
ポートしている。これらは最適なシナリオのプロトコルである。<br>
<a class="Identifier" href="wayland.html#wayland-focus-steal">wayland-focus-steal</a>&nbsp;を参照。この場合のセレクションは基本的に &quot;clipboard&quot; を<br>
指す。Wayland コンポジタがこれらのプロトコルをサポートしているかどうかを確認す<br>
るには、wayland-info コマンドを実行する。このコマンドは、あなたのシステムでは<br>
libwayland にバンドルされているはずである:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wayland-info | grep -E '(ext_data_control|zwlr_data_control)'</div>
grep で一致するものが見つかった場合、システムにはどちらか、または両方のプロト<br>
コルが存在する。一致するものが見つからない場合、詳細については<br>
<a class="Identifier" href="wayland.html#wayland-focus-steal">wayland-focus-steal</a>&nbsp;を参照。<br>
<br>
X11 から移行する場合、通常の Waylandセレクション は X11 のクリップボードセレク<br>
ションに相当し、プライマリ Wayland セレクションは X11 のプライマリセレクション<br>
に相当する。これらのセレクションへのアクセスは Vim の X11 と同様で、+ レジスタ<br>
が通常のセレクション、* レジスタがプライマリセレクションである。<span class="Todo">Note</span>&nbsp;コンポジ<br>
タがプライマリセレクションをサポートしていない可能性があることに注意。詳細は<br>
<a class="Identifier" href="wayland.html#wayland-primary-selection">wayland-primary-selection</a>&nbsp;を参照。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="wayland.html#wayland-persist" name="wayland-persist">wayland-persist</a><br>
X11 のカットバッファを使用する場合、Wayland にはそのような機能は存在しない。そ<br>
のような機能をエミュレートするには、Wayland クライアントが存在する場合にセレク<br>
ションデータを保持するために、別のクリップボードマネージャーを使用する必要があ<br>
る。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="wayland.html#wayland-and-x11" name="wayland-and-x11">wayland-and-x11</a><br>
使用している Vim のバージョンが X11 と Wayland の両方のサポートでコンパイルさ<br>
れている場合、Vim は&nbsp;<a class="Type" href="options.html#'clipmethod'">'clipmethod'</a>&nbsp;オプションを使用してクリップボードにアクセス<br>
するときにどちらを使用するかを決定する。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="wayland.html#wayland-primary-selection" name="wayland-primary-selection">wayland-primary-selection</a><br>
X11 スタイルのプライマリセレクションが便利だと感じる場合、Wayland も独自のプロ<br>
トコルでこの動作を実装している:<br>
<br>
- プライマリセレクションプロトコルは最も広くサポートされているが、使用するには<br>
&nbsp;&nbsp;フォーカスが必要である。<a class="Identifier" href="wayland.html#wayland-focus-steal">wayland-focus-steal</a>&nbsp;を参照。<br>
<br>
- システムで利用可能なデータ制御プロトコル (ext プロトコルや wlr プロトコルな<br>
&nbsp;&nbsp;ど) を使用している場合は、プライマリセレクションもサポートされる。ただし、<br>
&nbsp;&nbsp;wlr-data-control プロトコルのバージョン 1 (プロトコル名の 'v1' とは異なる)<br>
&nbsp;&nbsp;を使用している場合は、プライマリセレクションプロトコルがフォールバックとして<br>
&nbsp;&nbsp;使用される。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="wayland.html#wayland-focus-steal" name="wayland-focus-steal">wayland-focus-steal</a>&nbsp;<a class="Constant" href="wayland.html#wayland-gnome" name="wayland-gnome">wayland-gnome</a><br>
Wayland で GNOME デスクトップ環境を使用している場合、この記事の執筆時点では、<br>
Vim などの外部クライアントがフォーカスされていない状態でクリップボードにアクセ<br>
スしたり、クリップボードを変更したりする手段はない。この場合のフォーカスされて<br>
いるの意味は、クライアントが何らかの入力イベント (ウィンドウがフォーカスされて<br>
いるなど) を受信したことを意味する。これは、wlr-data-control-unstable-v1 プロ<br>
トコルと ext-data-control-v1 プロトコルによって解決される。Wayland コンポジタ<br>
が上記のプロトコルをサポートしていない場合は、上記の説明が適用される。<br>
<br>
この問題を解決するため、Vim は一時的に透明なトップレベルサーフェスを作成するこ<br>
とで、クリップボードにアクセスするためにフォーカスを取得する方法を実装してい<br>
る。これはデフォルトでは無効になっているが、<a class="Type" href="options.html#'wlsteal'">'wlsteal'</a>&nbsp;オプションで有効にでき<br>
る。さらに、キーボード付きのシート、<a class="Type" href="options.html#'wlseat'">'wlseat'</a>&nbsp;を参照、と xdg-shell プロトコルが<br>
利用可能である必要がある。<br>
<br>
<span class="Todo">Note</span>&nbsp;この方法は、フォーカスを奪取することによるいくつかの副作用を引き起こす可<br>
能性があることに注意。例えば、デスクトップ環境に現在開いているアプリを表示する<br>
タスクバーがある場合、Vim がフォーカスを奪取しようとすると、ウィンドウを開いて<br>
すぐに閉じたかのように「ちらつく」ことがある。<br>
さらに、フルスクリーンモードの場合、作成されたサーフェスがフォーカスを取得しな<br>
いため、このフォーカス奪取は機能しない。この場合、Vim は一時的にフリーズしたよ<br>
うに見える。詳細については、<a class="Type" href="options.html#'wltimeoutlen'">'wltimeoutlen'</a>&nbsp;を参照。<br>
<br>
&nbsp;vim:tw=78:ts=8:noet:ft=help:norl:<br>
</div>
